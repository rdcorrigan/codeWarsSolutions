const calc=t=>{let e=t.split("").filter(t=>/\S/.test(t)),s=e.filter(t=>/\*|\/|\+|\-/.test(t)),h,l,n,_,r,g=[],p=[],f=[];if(!s.length)return Number(t);e.forEach((t,e)=>"("===t?g.push(e):null);let i=t=>{for(h=t.length-2;h>=0&&/-/.test(t[h])&&/[^\d\)]/.test(t[h-1])&&/\d|\(/.test(t[h+1]);h--){for(l=h;/\d|\./.test(t[l+1]);)p.push(t[l+1]),f.push(l),l++;f.push(l),t.splice(f[0],f[f.length-1]+1-f[0],-1*Number(p.join("")))}},u=(t,e)=>{for(;g.length;){for(h=g[g.length-1]+1;")"!==t[h];)e.push(t[h]),h++;1===e.length?b(t,g,e[0]):o(t,e)}},o=(t,e,s=[])=>{for(h=0;h<e.length;h++)if(/\*|\//.test(e[h])){s.push(e[h],h);break}for(/\*|\//.test(s[0])&&c(t,e,s),h=0;h<e.length;h++)if("string"==typeof e[h]&&(/\-/.test(e[h])||/\+/.test(e[h]))){s.push(e[h],h);break}/\+|\-/.test(s[0])&&c(t,e,s)},c=(t,e,s,h=[],n=[],g=[])=>{for(l=s[1];/\d|\./.test(e[l-1]);)h.unshift(e[l-1]),l--;for(_=l,g.push(_),h.length&&(h=Number(h.join(""))),l=s[1];l<e.length&&/\d|\./.test(e[l+1]);)n.push(e[l+1]),l++;r=l,g.push(r),$(t,e,s,h,n=Number(n.join("")),g)},$=(t,e,s,h,l,_)=>{switch(s[0]){case"*":n=h*l;break;case"/":n=h/l;break;case"+":n=h+l;break;case"-":n=h-l}a(t,e,n,_)},a=(t,e,s,h)=>{e.splice(_,h[1]-h[0]+1,s),e.length>1&&o(t,e,operator=[],preOperator=[],postOperator=[],h=[]),b(t,g,s)},b=(t,e,s,h=[])=>{if(t.forEach((t,e)=>")"===t?h.push(e):null),e.length&&(t.splice(e[e.length-1],h[0]+1-e[e.length-1],s),"-"===t[e[e.length-1]-1]&&t.splice(e[e.length-1]-1,h[0]+1-e[e.length-1],-1*s),e.pop()),1===t.length)return t[0];e.length?u(t,parSequence=[]):o(t,t)};return i(e),g.length?u(e,parSequence=[]):o(e,e),e[0]};

// console.log(calc('(2 / (4 - 2 + 3.33 * 5 / 7) * 4) - -6')); // 7.8271

console.log(calc('12* 123/-(-5 + 2)')); // 492

// console.log(calc('-(3+42)')); // 2